{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://example.org/schemas/source_record.schema.json",
  "title": "SourceRecord",
  "type": "object",
  "additionalProperties": false,
  "required": [
    "repo",
    "html_url",
    "default_branch",
    "sha",
    "discovered_at",
    "query_hits"
  ],
  "properties": {
    "repo": {
      "type": "string",
      "description": "GitHub repo in owner/name format",
      "pattern": "^[A-Za-z0-9_.-]+/[A-Za-z0-9_.-]+$"
    },
    "html_url": {
      "type": "string",
      "description": "Human-facing GitHub URL",
      "format": "uri",
      "pattern": "^https://github\\.com/"
    },
    "default_branch": {
      "type": "string",
      "minLength": 1
    },
    "sha": {
      "type": "string",
      "description": "Pinned commit SHA (full 40 hex chars recommended)",
      "pattern": "^[a-fA-F0-9]{40}$"
    },
    "license_spdx": {
      "type": ["string", "null"],
      "description": "SPDX identifier if GitHub provides it (e.g., MIT, Apache-2.0)",
      "minLength": 1
    },
    "discovered_at": {
      "type": "string",
      "description": "ISO-8601 UTC timestamp",
      "format": "date-time"
    },
    "query_hits": {
      "type": "array",
      "description": "Which seeds/queries discovered this repo",
      "items": { "type": "string", "minLength": 1 },
      "minItems": 1,
      "uniqueItems": true
    },
    "repo_meta": {
      "type": "object",
      "description": "Optional small metadata for filtering/debugging",
      "additionalProperties": false,
      "properties": {
        "archived": { "type": "boolean" },
        "fork": { "type": "boolean" },
        "stargazers_count": { "type": "integer", "minimum": 0 },
        "pushed_at": { "type": ["string", "null"], "format": "date-time" }
      }
    }
  }
}